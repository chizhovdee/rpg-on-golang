(function(){var t,e,r,i,n,s,o,u,h,c,l=[].slice,a=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1},f=function(t,e){function r(){this.constructor=t}for(var i in e)p.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},p={}.hasOwnProperty,d=function(t,e){return function(){return t.apply(e,arguments)}};r={bind:function(t,e){var r,i,n,s,o;for(i=t.split(" "),this.hasOwnProperty("_callbacks")||this._callbacks||(this._callbacks={}),n=0,s=i.length;s>n;n++)o=i[n],(r=this._callbacks)[o]||(r[o]=[]),this._callbacks[o].push(e);return this},one:function(t,e){var r;return this.bind(t,r=function(){return this.unbind(t,r),e.apply(this,arguments)})},trigger:function(){var t,e,r,i,n,s,o;if(t=1<=arguments.length?l.call(arguments,0):[],r=t.shift(),s=null!=(o=this._callbacks)?o[r]:void 0){for(i=0,n=s.length;n>i&&(e=s[i],e.apply(this,t)!==!1);i++);return!0}},listenTo:function(t,e,r){return t.bind(e,r),this.listeningTo||(this.listeningTo=[]),this.listeningTo.push({obj:t,ev:e,callback:r}),this},listenToOnce:function(t,e,r){var i,n;return n=this.listeningToOnce||(this.listeningToOnce=[]),t.bind(e,i=function(){var s,o,u,h,c;for(o=-1,s=u=0,h=n.length;h>u;s=++u)c=n[s],c.obj===t&&c.ev===e&&c.callback===i&&(o=s);return t.unbind(e,i),-1!==o&&n.splice(o,1),r.apply(this,arguments)}),n.push({obj:t,ev:e,callback:i}),this},stopListening:function(e,r,i){var n,s,o,u,h,c,l,f,p,d,g,y,v,b,m,_,w,A;if(0===arguments.length){for(_=[this.listeningTo,this.listeningToOnce],h=0,f=_.length;f>h;h++)if(y=_[h],null!=y?y.length:void 0)for(c=0,p=y.length;p>c;c++)v=y[c],v.obj.unbind(v.ev,v.callback);this.listeningTo=void 0,this.listeningToOnce=void 0}else if(e)for(r=r?r.split(" "):[void 0],w=[this.listeningTo,this.listeningToOnce],l=0,d=w.length;d>l;l++)if(y=w[l])for(b=0,g=r.length;g>b;b++)for(s=r[b],u=m=A=y.length-1;0>=A?0>=m:m>=0;u=0>=A?++m:--m)v=y[u],v.obj===e&&(i&&v.callback!==i||(s&&s!==v.ev?s&&(o=v.ev.split(" "),a.call(o,s)>=0&&(o=function(){var t,e,r;for(r=[],e=0,t=o.length;t>e;e++)n=o[e],n!==s&&r.push(n);return r}(),v.ev=t.trim(o.join(" ")),v.obj.unbind(s,v.callback))):(v.obj.unbind(v.ev,v.callback),-1!==u&&y.splice(u,1))));return this},unbind:function(t,e){var r,i,n,s,o,u,h,c,l,a;if(0===arguments.length)return this._callbacks={},this;if(!t)return this;for(i=t.split(" "),s=0,u=i.length;u>s;s++)if(l=i[s],c=null!=(a=this._callbacks)?a[l]:void 0)if(e){for(n=o=0,h=c.length;h>o;n=++o)if(r=c[n],r===e){c=c.slice(),c.splice(n,1),this._callbacks[l]=c;break}}else delete this._callbacks[l];return this}},r.on=r.bind,r.off=r.unbind,i={trace:!0,logPrefix:"(App)",log:function(){var t;return t=1<=arguments.length?l.call(arguments,0):[],this.trace?(this.logPrefix&&t.unshift(this.logPrefix),"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,t),this):void 0}},c=["included","extended"],s=function(){function t(){"function"==typeof this.init&&this.init.apply(this,arguments)}return t.include=function(t){var e,r,i;if(!t)throw new Error("include(obj) requires obj");for(e in t)i=t[e],a.call(c,e)<0&&(this.prototype[e]=i);return null!=(r=t.included)&&r.apply(this),this},t.extend=function(t){var e,r,i;if(!t)throw new Error("extend(obj) requires obj");for(e in t)i=t[e],a.call(c,e)<0&&(this[e]=i);return null!=(r=t.extended)&&r.apply(this),this},t.proxy=function(t){return function(e){return function(){return t.apply(e,arguments)}}(this)},t.prototype.proxy=function(t){return function(e){return function(){return t.apply(e,arguments)}}(this)},t}(),n=function(e){function i(t){i.__super__.constructor.apply(this,arguments),null!=this.constructor.uuid&&"function"==typeof this.constructor.uuid?(this.cid=this.constructor.uuid(),this.id||(this.id=this.cid)):this.cid=(null!=t?t.cid:void 0)||this.constructor.uid("c-"),t&&this.load(t)}return f(i,e),i.extend(r),i.include(r),i.records=[],i.irecords={},i.attributes=[],i.configure=function(){var t,e;return e=arguments[0],t=2<=arguments.length?l.call(arguments,1):[],this.className=e,this.deleteAll(),t.length&&(this.attributes=t),this.attributes&&(this.attributes=h(this.attributes)),this.attributes||(this.attributes=[]),this.unbind(),this},i.toString=function(){return this.className+"("+this.attributes.join(", ")+")"},i.find=function(t,e){var r;return null==e&&(e=this.notFound),(null!=(r=this.irecords[t])?r.clone():void 0)||("function"==typeof e?e(t):void 0)},i.findAll=function(t,e){var r,i,n,s;for(s=[],i=0,n=t.length;n>i;i++)r=t[i],this.find(r,e)&&s.push(this.find(r));return s},i.notFound=function(t){return null},i.exists=function(t){return Boolean(this.irecords[t])},i.addRecord=function(t,e){var r;return(r=this.irecords[t.id||t.cid])?r.refresh(t):(t.id||(t.id=t.cid),this.irecords[t.id]=this.irecords[t.cid]=t,void 0!==e?this.records.splice(e,0,t):this.records.push(t)),t},i.refresh=function(t,e){var r,i,n,s,o;for(null==e&&(e={}),e.clear&&this.deleteAll(),s=this.fromJSON(t),Array.isArray(s)||(s=[s]),r=0,i=s.length;i>r;r++)n=s[r],this.addRecord(n);return this.sort(),o=this.cloneArray(s),this.trigger("refresh",o,e),o},i.select=function(t){var e,r,i,n,s;for(n=this.records,s=[],e=0,r=n.length;r>e;e++)i=n[e],t(i)&&s.push(i.clone());return s},i.findByAttribute=function(t,e){var r,i,n,s;for(s=this.records,r=0,i=s.length;i>r;r++)if(n=s[r],n[t]===e)return n.clone();return null},i.findAllByAttribute=function(t,e){return this.select(function(r){return r[t]===e})},i.each=function(t){var e,r,i,n,s;for(n=this.records,s=[],e=0,r=n.length;r>e;e++)i=n[e],s.push(t(i.clone()));return s},i.all=function(){return this.cloneArray(this.records)},i.slice=function(t,e){return null==t&&(t=0),this.cloneArray(this.records.slice(t,e))},i.first=function(t){var e;return null==t&&(t=1),t>1?this.cloneArray(this.records.slice(0,t)):null!=(e=this.records[0])?e.clone():void 0},i.last=function(t){var e;return"number"==typeof t?this.cloneArray(this.records.slice(-t)):null!=(e=this.records[this.records.length-1])?e.clone():void 0},i.count=function(){return this.records.length},i.deleteAll=function(){return this.records=[],this.irecords={}},i.destroyAll=function(t){var e,r,i,n,s;for(n=this.records,s=[],e=0,r=n.length;r>e;e++)i=n[e],s.push(i.destroy(t));return s},i.update=function(t,e,r){return this.find(t).updateAttributes(e,r)},i.create=function(t,e){var r;return r=new this(t),r.save(e)},i.destroy=function(t,e){var r;return null!=(r=this.find(t))?r.destroy(e):void 0},i.change=function(t){return"function"==typeof t?this.bind("change",t):this.trigger.apply(this,["change"].concat(l.call(arguments)))},i.fetch=function(t){return"function"==typeof t?this.bind("fetch",t):this.trigger.apply(this,["fetch"].concat(l.call(arguments)))},i.toJSON=function(){return this.records},i.beforeFromJSON=function(t){return t},i.fromJSON=function(t){var e,r,i,n;if(t){if("string"==typeof t&&(t=JSON.parse(t)),t=this.beforeFromJSON(t),Array.isArray(t)){for(i=[],e=0,r=t.length;r>e;e++)n=t[e],n instanceof this?i.push(n):i.push(new this(n));return i}return t instanceof this?t:new this(t)}},i.fromForm=function(){var t;return(t=new this).fromForm.apply(t,arguments)},i.sort=function(){return this.comparator&&this.records.sort(this.comparator),this},i.cloneArray=function(t){var e,r,i,n;for(i=[],e=0,r=t.length;r>e;e++)n=t[e],i.push(n.clone());return i},i.idCounter=0,i.uid=function(t){var e;return null==t&&(t=""),e=t+this.idCounter++,this.exists(e)&&(e=this.uid(t)),e},i.prototype.isNew=function(){return!this.exists()},i.prototype.isValid=function(){return!this.validate()},i.prototype.validate=function(){},i.prototype.load=function(t){var e,r;t.id&&(this.id=t.id);for(e in t)if(r=t[e],"function"==typeof this[e]){if("function"==typeof r)continue;this[e](r)}else this[e]=r;return this},i.prototype.attributes=function(){var t,e,r,i,n;for(n={},i=this.constructor.attributes,t=0,r=i.length;r>t;t++)e=i[t],e in this&&("function"==typeof this[e]?n[e]=this[e]():n[e]=this[e]);return this.id&&(n.id=this.id),n},i.prototype.eql=function(t){return t&&t.constructor===this.constructor&&(t.cid===this.cid||t.id&&t.id===this.id)},i.prototype.save=function(t){var e,r;return null==t&&(t={}),t.validate!==!1&&(e=this.validate())?(this.trigger("error",this,e),!1):(this.trigger("beforeSave",this,t),r=this.isNew()?this.create(t):this.update(t),this.stripCloneAttrs(),this.trigger("save",r,t),r)},i.prototype.stripCloneAttrs=function(){var t,e;if(!this.hasOwnProperty("cid")){for(t in this)p.call(this,t)&&(e=this[t],a.call(this.constructor.attributes,t)>=0&&delete this[t]);return this}},i.prototype.updateAttribute=function(t,e,r){var i;return i={},i[t]=e,this.updateAttributes(i,r)},i.prototype.updateAttributes=function(t,e){return this.load(t),this.save(e)},i.prototype.changeID=function(t){var e;if(t!==this.id)return e=this.constructor.irecords,e[t]=e[this.id],this.cid!==this.id&&delete e[this.id],this.id=t},i.prototype.remove=function(t){var e,r,i,n,s;for(null==t&&(t={}),s=this.constructor.records.slice(0),e=r=0,i=s.length;i>r;e=++r)if(n=s[e],this.eql(n)){s.splice(e,1);break}return this.constructor.records=s,t.clear?(delete this.constructor.irecords[this.id],delete this.constructor.irecords[this.cid]):void 0},i.prototype.destroy=function(t){return null==t&&(t={}),null==t.clear&&(t.clear=!0),this.trigger("beforeDestroy",this,t),this.remove(t),this.destroyed=!0,this.trigger("destroy",this,t),this.trigger("change",this,"destroy",t),this.listeningTo&&this.stopListening(),this.unbind(),this},i.prototype.dup=function(t){var e,r;return null==t&&(t=!0),e=this.attributes(),t?delete e.id:e.cid=this.cid,r=new this.constructor(e),t||this._callbacks&&(r._callbacks=this._callbacks),r},i.prototype.clone=function(){return u(this)},i.prototype.reload=function(){var t;return this.isNew()?this:(t=this.constructor.find(this.id),this.load(t.attributes()),t)},i.prototype.refresh=function(t){return t=this.constructor.fromJSON(t),t.id&&this.id!==t.id&&this.changeID(t.id),this.constructor.irecords[this.id].load(t),this.trigger("refresh",this),this.trigger("change",this,"refresh"),this},i.prototype.toJSON=function(){return this.attributes()},i.prototype.toString=function(){return"<"+this.constructor.className+" ("+JSON.stringify(this)+")>"},i.prototype.fromForm=function(e){var r,i,n,s,o,u,h,c,l,a,f,p,d,g;for(g={},f=t(e).find("[type=checkbox]:not([value])"),i=0,u=f.length;u>i;i++)r=f[i],g[r.name]=t(r).prop("checked");for(p=t(e).find('[type=checkbox][name$="[]"]'),n=0,h=p.length;h>n;n++)r=p[n],l=r.name.replace(/\[\]$/,""),g[l]||(g[l]=[]),t(r).prop("checked")&&g[l].push(r.value);for(d=t(e).serializeArray(),o=0,c=d.length;c>o;o++)s=d[o],g[a=s.name]||(g[a]=s.value);return this.load(g)},i.prototype.exists=function(){return this.constructor.exists(this.id)},i.prototype.update=function(t){var e,r;return this.trigger("beforeUpdate",this,t),r=this.constructor.irecords,r[this.id].load(this.attributes()),this.constructor.sort(),e=r[this.id].clone(),e.trigger("update",e,t),e.trigger("change",e,"update",t),e},i.prototype.create=function(t){var e,r;return this.trigger("beforeCreate",this,t),this.id||(this.id=this.cid),r=this.dup(!1),this.constructor.addRecord(r,t.idx),this.constructor.sort(),e=r.clone(),e.trigger("create",e,t),e.trigger("change",e,"create",t),e},i.prototype.bind=function(){var t;return t=this.constructor.irecords[this.id]||this,r.bind.apply(t,arguments)},i.prototype.one=function(){var t;return t=this.constructor.irecords[this.id]||this,r.one.apply(t,arguments)},i.prototype.unbind=function(){var t;return t=this.constructor.irecords[this.id]||this,r.unbind.apply(t,arguments)},i.prototype.trigger=function(){var t;return r.trigger.apply(this,arguments),"refresh"===arguments[0]?!0:(t=this.constructor).trigger.apply(t,arguments)},i}(s),n.prototype.on=n.prototype.bind,n.prototype.off=n.prototype.unbind,e=function(e){function n(e){this.release=d(this.release,this);var r,i,s,o,u;this.options=e,o=this.options;for(i in o)u=o[i],this[i]=u;for(this.el||(this.el=document.createElement(this.tag)),this.el=t(this.el),this.className&&this.el.addClass(this.className),this.attributes&&this.el.attr(this.attributes),this.events||(this.events=this.constructor.events),this.elements||(this.elements=this.constructor.elements),r=this;s=r.constructor.__super__;)s.events&&(this.events=t.extend({},s.events,this.events)),s.elements&&(this.elements=t.extend({},s.elements,this.elements)),r=s;this.events&&this.delegateEvents(this.events),this.elements&&this.refreshElements(),n.__super__.constructor.apply(this,arguments)}return f(n,e),n.include(r),n.include(i),n.prototype.eventSplitter=/^(\S+)\s*(.*)$/,n.prototype.tag="div",n.prototype.release=function(){return this.trigger("release",this),this.el.remove(),this.unbind(),this.stopListening()},n.prototype.$=function(t){return this.el.find(t)},n.prototype.delegateEvents=function(t){var e,r,i,n,s,o;s=[];for(r in t){if(n=t[r],"function"==typeof n)n=function(t){return function(e){return function(){return e.apply(t,arguments),!0}}}(this)(n);else{if(!this[n])throw new Error(n+" doesn't exist");n=function(t){return function(e){return function(){return t[e].apply(t,arguments),!0}}}(this)(n)}i=r.match(this.eventSplitter),e=i[1],o=i[2],""===o?s.push(this.el.bind(e,n)):s.push(this.el.on(e,o,n))}return s},n.prototype.refreshElements=function(){var t,e,r,i;e=this.elements,r=[];for(t in e)i=e[t],r.push(this[i]=this.$(t));return r},n.prototype.delay=function(t,e){return setTimeout(this.proxy(t),e||0)},n.prototype.html=function(t){return this.el.html(t.el||t),this.refreshElements(),this.el},n.prototype.append=function(){var t,e,r;return e=1<=arguments.length?l.call(arguments,0):[],e=function(){var r,i,n;for(n=[],r=0,i=e.length;i>r;r++)t=e[r],n.push(t.el||t);return n}(),(r=this.el).append.apply(r,e),this.refreshElements(),this.el},n.prototype.appendTo=function(t){return this.el.appendTo(t.el||t),this.refreshElements(),this.el},n.prototype.prepend=function(){var t,e,r;return e=1<=arguments.length?l.call(arguments,0):[],e=function(){var r,i,n;for(n=[],r=0,i=e.length;i>r;r++)t=e[r],n.push(t.el||t);return n}(),(r=this.el).prepend.apply(r,e),this.refreshElements(),this.el},n.prototype.replace=function(e){var r,i,n;return e=e.el||e,"string"==typeof e&&(e=t.trim(e)),n=[this.el,t((null!=(i=t.parseHTML(e))?i[0]:void 0)||e)],r=n[0],this.el=n[1],r.replaceWith(this.el),this.delegateEvents(this.events),this.refreshElements(),this.el},n}(s),t=("undefined"!=typeof window&&null!==window?window.jQuery:void 0)||("undefined"!=typeof window&&null!==window?window.Zepto:void 0)||function(t){return t},u=Object.create||function(t){var e;return e=function(){},e.prototype=t,new e},h=function(t){return Array.prototype.slice.call(t,0)},o=this.Spine={},"undefined"!=typeof module&&null!==module&&(module.exports=o),o.version="1.6.1",o.$=t,o.Events=r,o.Log=i,o.Module=s,o.Controller=e,o.Model=n,s.extend.call(o,r),s.create=s.sub=e.create=e.sub=n.sub=function(t,e){var r;return r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e}(this),t&&r.include(t),e&&r.extend(e),"function"==typeof r.unbind&&r.unbind(),r},n.setup=function(t,e){var r;return null==e&&(e=[]),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e}(this),r.configure.apply(r,[t].concat(l.call(e))),r},o.Class=s}).call(this);